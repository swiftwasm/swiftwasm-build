From 908c3bd4e121a92798cbf3835ea7c051b3e3d9db Mon Sep 17 00:00:00 2001
From: Yuta Saito <kateinoigakukun@gmail.com>
Date: Sun, 29 Oct 2023 00:39:00 +0000
Subject: [PATCH] [wasm] import emulated wasi-libc module for mman apis

---
 Sources/Foundation/Data.swift       | 1 +
 Sources/Foundation/FileHandle.swift | 1 +
 2 files changed, 2 insertions(+)

diff --git a/Sources/Foundation/Data.swift b/Sources/Foundation/Data.swift
index de5c0400..5c7004f7 100644
--- a/Sources/Foundation/Data.swift
+++ b/Sources/Foundation/Data.swift
@@ -29,6 +29,7 @@
 @usableFromInline let memcpy = Glibc.memcpy
 @usableFromInline let memcmp = Glibc.memcmp
 #elseif canImport(WASILibc)
+@_implementationOnly import wasi_emulated_mman
 @usableFromInline let calloc = WASILibc.calloc
 @usableFromInline let malloc = WASILibc.malloc
 @usableFromInline let free = WASILibc.free
diff --git a/Sources/Foundation/FileHandle.swift b/Sources/Foundation/FileHandle.swift
index 4c42f26c..d882e078 100644
--- a/Sources/Foundation/FileHandle.swift
+++ b/Sources/Foundation/FileHandle.swift
@@ -26,6 +26,7 @@ fileprivate let _write = Glibc.write(_:_:_:)
 fileprivate let _close = Glibc.close(_:)
 #elseif canImport(WASILibc)
 import WASILibc
+@_implementationOnly import wasi_emulated_mman
 fileprivate let _read = WASILibc.read(_:_:_:)
 fileprivate let _write = WASILibc.write(_:_:_:)
 fileprivate let _close = WASILibc.close(_:)
-- 
2.43.0

