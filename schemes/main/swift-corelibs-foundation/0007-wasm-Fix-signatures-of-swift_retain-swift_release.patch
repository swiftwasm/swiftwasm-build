From 6e19f0dd7080950ea2cea39e743a95de84c344e7 Mon Sep 17 00:00:00 2001
From: Yuta Saito <kateinoigakukun@gmail.com>
Date: Sun, 4 Feb 2024 16:20:24 +0000
Subject: [PATCH] [wasm] Fix signatures of `swift_retain`/`swift_release`

---
 CoreFoundation/Base.subproj/CFPlatform.c | 2 +-
 CoreFoundation/Base.subproj/CFRuntime.c  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/CoreFoundation/Base.subproj/CFPlatform.c b/CoreFoundation/Base.subproj/CFPlatform.c
index bbb3cdba..fd893462 100644
--- a/CoreFoundation/Base.subproj/CFPlatform.c
+++ b/CoreFoundation/Base.subproj/CFPlatform.c
@@ -1625,7 +1625,7 @@ CF_PRIVATE int asprintf(char **ret, const char *format, ...) {
 #if DEPLOYMENT_RUNTIME_SWIFT
 #include <fcntl.h>
 
-extern void swift_retain(void *);
+extern void *swift_retain(void *);
 extern void swift_release(void *);
 
 #if SWIFT_CORELIBS_FOUNDATION_HAS_THREADS
diff --git a/CoreFoundation/Base.subproj/CFRuntime.c b/CoreFoundation/Base.subproj/CFRuntime.c
index 61e6b293..74605577 100644
--- a/CoreFoundation/Base.subproj/CFRuntime.c
+++ b/CoreFoundation/Base.subproj/CFRuntime.c
@@ -1411,7 +1411,7 @@ int DllMain( HINSTANCE hInstance, DWORD dwReason, LPVOID pReserved ) {
 #endif
 
 #if DEPLOYMENT_RUNTIME_SWIFT
-extern void swift_retain(void *);
+extern void *swift_retain(void *);
 #endif
 
 // For "tryR==true", a return of NULL means "failed".
-- 
2.43.0

