From 6e6fdb07fd6facfcf49e239a0cd118967026a764 Mon Sep 17 00:00:00 2001
From: Yuta Saito <kateinoigakukun@gmail.com>
Date: Fri, 2 Aug 2024 01:30:17 +0900
Subject: [PATCH] Skip sticky-bit check in `isDeletableFile` on WASI (#785)

WASI does not surface the sticky bit and getuid, so we cannot check
whether the file is actually deletable before attempting to delete it.
---
 .../FoundationEssentials/FileManager/FileManager+Files.swift    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Sources/FoundationEssentials/FileManager/FileManager+Files.swift b/Sources/FoundationEssentials/FileManager/FileManager+Files.swift
index b1e6f34..9cd9752 100644
--- a/Sources/FoundationEssentials/FileManager/FileManager+Files.swift
+++ b/Sources/FoundationEssentials/FileManager/FileManager+Files.swift
@@ -474,7 +474,7 @@ extension _FileManagerImpl {
             parent = fileManager.currentDirectoryPath
         }
 
-#if os(Windows)
+#if os(Windows) || os(WASI)
         return fileManager.isWritableFile(atPath: parent) && fileManager.isWritableFile(atPath: path)
 #else
         guard fileManager.isWritableFile(atPath: parent),
-- 
2.43.2

